; xin standard library

; boolean aliases
(: true 1)
(: false 0)
(: and &)
(: or |)
(: not !)
(: (bool x)
   (if x 'true' 'false'))

; identity function
(: (identity x) x)

; basic io
(: (log s)
   (<- os::stdout (+ (str s) '\n')))
(: (scan)
   (-> os::stdin))

; basic math
(: (!= a b) (! (= a b)))
(: (>= a b) (! (< a b)))
(: (<= a b) (! (> a b)))
(: (sqrt x) (^ x .5))
(: (pos? n) (> n 0))
(: (neg? n) (< n 0))
(: (factor? big small)
   (= (% big small) 0))
(: (max a b)
   (if (> a b) a b))
(: (min a b)
   (if (< a b) a b))

; iteration primitives: range, seq
(: (range start end step)
   (do (: (sub i acc)
          (if (< i end)
            (do (vec-add! acc i)
              (sub (+ i step) acc))
            acc))
     (sub start (vec))))

(: (seq n)
   (range 0 n 1))

; set abstraction over map
(: (set)
   (map))
(: (set-add! v)
   (map-set! v 0))
(: (set-del! v)
   (map-del! v))
(: (set-has v)
   (if (= (map-get v) 0)
     true
     false))
